# Tools to convert the CoNLL2003 NER corpora to GATE format

This repository contains two sets of scripts for creating the Conll2003 NER corpora
in GATE format: 
* prepare-deu.sh and prepare-eng.sh to create the conll-format files from
  the text corpora (licensed, need to get obtained separately) and the annotation files 
  (available from https://www.clips.uantwerpen.be/conll2003/ner/)
* convert-deu.sh and convert-eng.sh to convert the conll-format files to GATE format.

NOTE: the prepare-deu.sh script does not work correctly at the moment and cannot be 
used, so the german conll-format files must get created by you separately and then
be put into directory ./conll2003-deu.


The script prepare.sh expects three parameters for the  locations of the following files
First parameter for directory of
* ner.tgz from CoNLL 2003
* eng.raw.tar from CoNLL 2003
* deu.raw.tar from CoNLL 2003
Second parameter for directory of
* LDC94T5.tgz for the actual texts
Third parameter for directory of
* Reuters files <date>.zip

The tools will extract from these original locations into ./work 
and then processing will use the files in there, so there must be
enough disk space to temporarily hold all the files in ./work.
After the conversion is completed, ./work can be removed (but it is
not removed automatically).

If the script prepare.sh is run and a directory work already exists it is assumed 
to already contain the correctly expanded files and it will be used as is.

## Requirements

* Needs Java and Scala installed
* Needs GATE 8.4.x installed and the environment variable `GATE_HOME` set to the installation directory
* Only works on Linux, Mac and under Windows probably only in some form of Linux-compatibiity mode

## Steps 

* run ./prepare.sh dir1 dir2 dir3 where dir1 contains the conll2003 archives dir2 contains the LDC94T5 archive and dir3 contains the Reuters zip files
* this creates work/ner/deu.{train,testa,testb} and work/ner/eng.{train,testa,testb}
* NOTE: there will be a message about an incorrect number of lines in data files, but it seems this is just because of an added empty line at the end of eng.testa
* Run ./convert.sh : this will create a directory deu and a directory eng with subdirectories train, test and testb each and populate the directories with the GATE files.

Each of the result directories contains one GATE document in GATE XML format for each document identified in the corresponding input file. 

The following annotations are placed into the annotation set "Original markups":
* LOC, MISC, ORG, PER: for the entity annotations from the input. These annotations have the single feature startLineNr which identifies the (1-based) number of the original CoNLL input file where this entity started
* Token: for each input token one annotation is created. It contains the following features:
  * chunkBIO: the original BIO value of the column for chunks
  * lemma: the original value of the lemma columns (German only)
  * lineNr: the line number (1-based) of that token in the original CoNLL input file as generated by the script described above
  * neBIO: the original BIO value of the NE column
  * pos: the original value of the POS column

The conversion algorithm separates all tokens by spaces except there are no spaces before punctuation caracters !,-.:;? and 
there are no spaces after opening parentheses ({[ and before closing parentheses )}]
There is no space inserted before token 's but there is space inserted before a single ' because we cannot know if it is
the genetive of a plural or just used for quoting or something other.
For quote characters " a space is inserted before but not after all odd occurrences in a document and after but not before
all even occurrences.

All other tokens, including quote-like characters like '`, or characters like $Â£#~% if separate tokens in the input file are separated by 
spaces.
No space is added at the beginning or end of a sentence or beginning or end of a document.
